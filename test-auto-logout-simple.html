<!DOCTYPE html>
<html>
<head>
    <title>Auto-Logout Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Auto-Logout Test</h1>
    
    <div class="info status">
        <strong>Test Instructions:</strong>
        <ol>
            <li>Open browser console (F12)</li>
            <li>Log in to the application</li>
            <li>Look for these console messages in order:</li>
            <ul>
                <li>üîÑ User signed in, loading auto-logout settings...</li>
                <li>üîÑ Loading auto-logout settings from database...</li>
                <li>üîß Auto-logout settings loaded: {enabled: true, delayMinutes: 1}</li>
                <li>üë§ User logged in and settings loaded, setting up auto-logout functionality</li>
                <li>‚è±Ô∏è Setting inactivity timer for 1 minutes</li>
            </ul>
            <li>Don't interact with the page for 1 minute</li>
            <li>You should see: ‚è∞ Inactivity timeout reached, performing auto-logout</li>
            <li>You should be redirected to the login page</li>
        </ol>
    </div>

    <div class="warning status">
        <strong>If auto-logout is NOT working, check for these issues:</strong>
        <ul>
            <li>Console shows "Setting inactivity timer for 5 minutes" instead of 1</li>
            <li>No console messages about settings loading</li>
            <li>Error messages in console</li>
            <li>Timer never gets set up</li>
        </ul>
    </div>

    <div class="success status">
        <strong>Expected Database Values:</strong>
        <ul>
            <li>auto_logout_enabled: true</li>
            <li>auto_logout_delay_seconds: 60 (converts to 1 minute)</li>
        </ul>
    </div>

    <script>
        // Add a simple countdown timer to help with testing
        let countdown = 60; // 1 minute
        let countdownInterval;
        
        function startCountdown() {
            const countdownDiv = document.createElement('div');
            countdownDiv.id = 'countdown';
            countdownDiv.className = 'info status';
            countdownDiv.innerHTML = '<strong>Countdown to expected auto-logout:</strong> <span id="timer">60</span> seconds';
            document.body.appendChild(countdownDiv);
            
            countdownInterval = setInterval(() => {
                countdown--;
                document.getElementById('timer').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    countdownDiv.innerHTML = '<strong>Auto-logout should have happened now!</strong>';
                    countdownDiv.className = 'warning status';
                }
            }, 1000);
        }
        
        // Start countdown when page loads
        window.addEventListener('load', () => {
            setTimeout(startCountdown, 2000); // Start after 2 seconds
        });
        
        // Log any activity to help debug
        ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'].forEach(event => {
            document.addEventListener(event, () => {
                console.log(`üéØ Activity detected: ${event}`);
                // Reset our countdown when activity is detected
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                    countdown = 60;
                    startCountdown();
                }
            }, true);
        });
    </script>
</body>
</html>